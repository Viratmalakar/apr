<!DOCTYPE html>
<html>
<head>

<title>Dashboard Result</title>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<style>

body{

background:#0f2027;
font-family:Segoe UI;
color:white;
padding:20px;

}

h2{

color:#FFD700;

}

table{

border-collapse:collapse;
width:100%;
background:#1e2a38;
box-shadow:0 0 20px black;

}

th{

background:linear-gradient(45deg,#FFD700,#b8860b);
color:black;
padding:12px;
border:2px solid black;

}

td{

padding:10px;
border:1px solid #555;

}

button{

padding:10px 20px;
margin:10px;
background:gold;
border:none;
cursor:pointer;

}

input{

padding:10px;
margin:10px;
width:300px;

}

</style>

</head>

<body>

<h2>Agent Performance Report</h2>

<input type="text" id="search" placeholder="Search Employee ID or Name">

<button onclick="resetPage()">Reset</button>

<button onclick="copyPNG()">Copy Table</button>

<button onclick="downloadExcel()">Download Excel</button>

<div id="tableDiv">

<table id="table">

<tr>

{% for h in headers %}
<th>{{h}}</th>
{% endfor %}

</tr>

{% for row in tables %}

<tr>

{% for h in headers %}
<td>{{row[h]}}</td>
{% endfor %}

</tr>

{% endfor %}

</table>

</div>

<script>

document.getElementById("search").addEventListener("keyup", function(){

var value=this.value.toLowerCase();
var rows=document.querySelectorAll("#table tr");

rows.forEach(function(row,i){

if(i===0)return;

row.style.display=row.innerText.toLowerCase().includes(value)?"":"none";

});

});


function resetPage(){

window.location="/";

}


function downloadExcel(){

window.location="/download";

}


function copyPNG(){

html2canvas(document.querySelector("#tableDiv"),{

scale:3

}).then(canvas=>{

canvas.toBlob(function(blob){

navigator.clipboard.write([

new ClipboardItem({

"image/png":blob

})

]);

alert("Table copied as PNG");

});

});

}

</script>

</body>
</html>
