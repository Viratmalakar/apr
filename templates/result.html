<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<title>Agent Performance Dashboard</title>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>

body{
font-family:Segoe UI;
background:#0f172a;
margin:0;
padding:20px;
color:white;
}

.container{
max-width:1400px;
margin:auto;
}

.header{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:20px;
}

.title{
font-size:28px;
font-weight:bold;
color:#FFD700;
}

.controls{
display:flex;
gap:10px;
}

button{

padding:10px 20px;
border:none;
border-radius:6px;
cursor:pointer;
font-weight:bold;
}

.reset{
background:red;
color:white;
}

.copy{
background:#FFD700;
color:black;
}

.search{
padding:10px;
width:250px;
border-radius:6px;
border:none;
}

.table-container{
background:white;
padding:20px;
border-radius:10px;
overflow:auto;
}

table{

border-collapse:collapse;
width:100%;
color:black;
}

th{

background:linear-gradient(45deg,#FFD700,#b8860b);
color:black;
padding:12px;
font-size:15px;
}

td{

padding:10px;
border-bottom:1px solid #ddd;
}

tr:hover{

background:#f1f1f1;
}

.report-time{

margin-bottom:10px;
color:#FFD700;
}

</style>

</head>
<body>

<div class="container">

<div class="header">

<div class="title">Agent Performance Dashboard</div>

<div class="controls">

<input
type="text"
id="search"
class="search"
placeholder="Search Employee ID or Name"
onkeyup="searchTable()"
>

<button class="copy" onclick="copyImage()">Copy Table</button>

<button class="reset" onclick="resetPage()">Reset</button>

</div>

</div>

<div class="report-time">

Report Time : {{report_time}}

</div>

<div class="table-container" id="tableDiv">

<table id="table">

<thead>

<tr>

<th>Employee ID</th>
<th>Agent Name</th>
<th>Total Login</th>
<th>Total Net Login</th>
<th>Total Break</th>
<th>Total Meeting</th>
<th>AHT</th>
<th>Total Mature</th>
<th>IB Mature</th>
<th>OB Mature</th>

</tr>

</thead>

<tbody>

{% for row in rows %}

<tr>

<td>{{row["Employee ID"]}}</td>
<td>{{row["Agent Name"]}}</td>
<td>{{row["Total Login"]}}</td>
<td>{{row["Total Net Login"]}}</td>
<td>{{row["Total Break"]}}</td>
<td>{{row["Total Meeting"]}}</td>
<td>{{row["AHT"]}}</td>
<td>{{row["Total Mature"]}}</td>
<td>{{row["IB Mature"]}}</td>
<td>{{row["OB Mature"]}}</td>

</tr>

{% endfor %}

</tbody>

</table>

</div>

</div>

<script>

function resetPage(){

localStorage.clear();
sessionStorage.clear();

window.location.href="/";

}

function searchTable(){

let input=document.getElementById("search").value.toLowerCase();

let rows=document.querySelectorAll("#table tbody tr");

rows.forEach(row=>{

let id=row.cells[0].innerText.toLowerCase();
let name=row.cells[1].innerText.toLowerCase();

if(id.includes(input)||name.includes(input))
row.style.display="";
else
row.style.display="none";

});

}

function copyImage(){

html2canvas(document.getElementById("tableDiv"),{

scale:4

}).then(canvas=>{

canvas.toBlob(blob=>{

const item=new ClipboardItem({"image/png":blob});

navigator.clipboard.write([item]);

alert("Table copied as image");

});

});

}

</script>

</body>
</html>
